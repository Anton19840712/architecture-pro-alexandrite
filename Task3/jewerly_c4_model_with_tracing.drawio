<mxfile host="app.diagrams.net" agent="Claude" version="22.1.0">
  <diagram name="C4 with Tracing" id="tracing-diagram">
    <mxGraphModel dx="1735" dy="1140" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="1400" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- System Boundary -->
        <object placeholders="1" c4Name="Jewerly Store System" c4Type="SystemScopeBoundary" c4Application="Software System" label="&lt;font style=&quot;font-size: 16px&quot;&gt;&lt;b&gt;%c4Name%&lt;/b&gt;&lt;/font&gt;&lt;div&gt;[%c4Application%]&lt;/div&gt;" id="system-boundary">
          <mxCell style="rounded=1;fontSize=11;whiteSpace=wrap;html=1;dashed=1;arcSize=20;fillColor=none;strokeColor=#666666;fontColor=#333333;labelBackgroundColor=none;align=left;verticalAlign=bottom;spacing=10;dashPattern=8 4;" parent="1" vertex="1">
            <mxGeometry x="300" y="200" width="1250" height="1100" as="geometry" />
          </mxCell>
        </object>

        <!-- Persons -->
        <object placeholders="1" c4Name="Customer" c4Type="Person" c4Description="B2C customer" label="&lt;b&gt;%c4Name%&lt;/b&gt;&lt;div&gt;[%c4Type%]&lt;/div&gt;&lt;div&gt;%c4Description%&lt;/div&gt;" id="customer">
          <mxCell style="html=1;fontSize=11;dashed=0;whiteSpace=wrap;fillColor=#6C6477;strokeColor=#4D4D4D;fontColor=#ffffff;shape=mxgraph.c4.person2;align=center;" parent="1" vertex="1">
            <mxGeometry x="80" y="220" width="160" height="140" as="geometry" />
          </mxCell>
        </object>

        <object placeholders="1" c4Name="Seller" c4Type="Person" c4Description="CRM user" label="&lt;b&gt;%c4Name%&lt;/b&gt;&lt;div&gt;[%c4Type%]&lt;/div&gt;&lt;div&gt;%c4Description%&lt;/div&gt;" id="seller">
          <mxCell style="html=1;fontSize=11;dashed=0;whiteSpace=wrap;fillColor=#083F75;strokeColor=#06315C;fontColor=#ffffff;shape=mxgraph.c4.person2;align=center;" parent="1" vertex="1">
            <mxGeometry x="80" y="420" width="160" height="140" as="geometry" />
          </mxCell>
        </object>

        <object placeholders="1" c4Name="API User" c4Type="Person" c4Description="B2B partner" label="&lt;b&gt;%c4Name%&lt;/b&gt;&lt;div&gt;[%c4Type%]&lt;/div&gt;&lt;div&gt;%c4Description%&lt;/div&gt;" id="api-user">
          <mxCell style="html=1;fontSize=11;dashed=0;whiteSpace=wrap;fillColor=#6C6477;strokeColor=#4D4D4D;fontColor=#ffffff;shape=mxgraph.c4.person2;align=center;" parent="1" vertex="1">
            <mxGeometry x="80" y="620" width="160" height="140" as="geometry" />
          </mxCell>
        </object>

        <object placeholders="1" c4Name="Operator" c4Type="Person" c4Description="MES user" label="&lt;b&gt;%c4Name%&lt;/b&gt;&lt;div&gt;[%c4Type%]&lt;/div&gt;&lt;div&gt;%c4Description%&lt;/div&gt;" id="operator">
          <mxCell style="html=1;fontSize=11;dashed=0;whiteSpace=wrap;fillColor=#083F75;strokeColor=#06315C;fontColor=#ffffff;shape=mxgraph.c4.person2;align=center;" parent="1" vertex="1">
            <mxGeometry x="80" y="900" width="160" height="140" as="geometry" />
          </mxCell>
        </object>

        <!-- Frontend Containers -->
        <object placeholders="1" c4Name="Internet Shop" c4Type="Container" c4Technology="Vue, TypeScript" c4Description="Web frontend for customers" label="&lt;b&gt;%c4Name%&lt;/b&gt;&lt;div&gt;[%c4Type%: %c4Technology%]&lt;/div&gt;&lt;div&gt;%c4Description%&lt;/div&gt;" id="shop-frontend">
          <mxCell style="shape=mxgraph.c4.webBrowserContainer2;whiteSpace=wrap;html=1;boundedLbl=1;rounded=0;labelBackgroundColor=none;strokeColor=#118ACD;fillColor=#23A2D9;fontSize=11;fontColor=#ffffff;align=center;" parent="1" vertex="1">
            <mxGeometry x="340" y="230" width="200" height="130" as="geometry" />
          </mxCell>
        </object>

        <object placeholders="1" c4Name="CRM" c4Type="Container" c4Technology="Vue, TypeScript" c4Description="CRM frontend" label="&lt;b&gt;%c4Name%&lt;/b&gt;&lt;div&gt;[%c4Type%: %c4Technology%]&lt;/div&gt;&lt;div&gt;%c4Description%&lt;/div&gt;" id="crm-frontend">
          <mxCell style="shape=mxgraph.c4.webBrowserContainer2;whiteSpace=wrap;html=1;boundedLbl=1;rounded=0;labelBackgroundColor=none;strokeColor=#118ACD;fillColor=#23A2D9;fontSize=11;fontColor=#ffffff;align=center;" parent="1" vertex="1">
            <mxGeometry x="340" y="430" width="200" height="130" as="geometry" />
          </mxCell>
        </object>

        <object placeholders="1" c4Name="MES" c4Type="Container" c4Technology="React, TypeScript" c4Description="MES frontend" label="&lt;b&gt;%c4Name%&lt;/b&gt;&lt;div&gt;[%c4Type%: %c4Technology%]&lt;/div&gt;&lt;div&gt;%c4Description%&lt;/div&gt;" id="mes-frontend">
          <mxCell style="shape=mxgraph.c4.webBrowserContainer2;whiteSpace=wrap;html=1;boundedLbl=1;rounded=0;labelBackgroundColor=none;strokeColor=#118ACD;fillColor=#23A2D9;fontSize=11;fontColor=#ffffff;align=center;" parent="1" vertex="1">
            <mxGeometry x="340" y="910" width="200" height="130" as="geometry" />
          </mxCell>
        </object>

        <!-- Backend APIs -->
        <object placeholders="1" c4Name="Shop API" c4Type="Container" c4Technology="Spring Boot + OTel" c4Description="Shop backend with tracing" label="&lt;b&gt;%c4Name%&lt;/b&gt;&lt;div&gt;[%c4Type%: %c4Technology%]&lt;/div&gt;&lt;div&gt;%c4Description%&lt;/div&gt;" id="shop-api">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;fontSize=11;labelBackgroundColor=none;fillColor=#23A2D9;fontColor=#ffffff;align=center;arcSize=10;strokeColor=#0E7DAD;" parent="1" vertex="1">
            <mxGeometry x="620" y="250" width="200" height="90" as="geometry" />
          </mxCell>
        </object>

        <object placeholders="1" c4Name="CRM API" c4Type="Container" c4Technology="Spring Boot + OTel" c4Description="CRM backend with tracing" label="&lt;b&gt;%c4Name%&lt;/b&gt;&lt;div&gt;[%c4Type%: %c4Technology%]&lt;/div&gt;&lt;div&gt;%c4Description%&lt;/div&gt;" id="crm-api">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;fontSize=11;labelBackgroundColor=none;fillColor=#23A2D9;fontColor=#ffffff;align=center;arcSize=10;strokeColor=#0E7DAD;" parent="1" vertex="1">
            <mxGeometry x="620" y="450" width="200" height="90" as="geometry" />
          </mxCell>
        </object>

        <object placeholders="1" c4Name="MES API" c4Type="Container" c4Technology="C# + OTel" c4Description="MES backend with tracing" label="&lt;b&gt;%c4Name%&lt;/b&gt;&lt;div&gt;[%c4Type%: %c4Technology%]&lt;/div&gt;&lt;div&gt;%c4Description%&lt;/div&gt;" id="mes-api">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;fontSize=11;labelBackgroundColor=none;fillColor=#23A2D9;fontColor=#ffffff;align=center;arcSize=10;strokeColor=#0E7DAD;" parent="1" vertex="1">
            <mxGeometry x="620" y="710" width="200" height="90" as="geometry" />
          </mxCell>
        </object>

        <!-- Databases -->
        <object placeholders="1" c4Name="Shop DB" c4Type="Container" c4Technology="PostgreSQL" c4Description="Shop and CRM data" label="&lt;b&gt;%c4Name%&lt;/b&gt;&lt;div&gt;[%c4Type%: %c4Technology%]&lt;/div&gt;" id="shop-db">
          <mxCell style="shape=cylinder3;size=15;whiteSpace=wrap;html=1;boundedLbl=1;rounded=0;labelBackgroundColor=none;fillColor=#23A2D9;fontSize=11;fontColor=#ffffff;align=center;strokeColor=#0E7DAD;" parent="1" vertex="1">
            <mxGeometry x="920" y="330" width="140" height="100" as="geometry" />
          </mxCell>
        </object>

        <object placeholders="1" c4Name="MES DB" c4Type="Container" c4Technology="PostgreSQL" c4Description="MES data" label="&lt;b&gt;%c4Name%&lt;/b&gt;&lt;div&gt;[%c4Type%: %c4Technology%]&lt;/div&gt;" id="mes-db">
          <mxCell style="shape=cylinder3;size=15;whiteSpace=wrap;html=1;boundedLbl=1;rounded=0;labelBackgroundColor=none;fillColor=#23A2D9;fontSize=11;fontColor=#ffffff;align=center;strokeColor=#0E7DAD;" parent="1" vertex="1">
            <mxGeometry x="920" y="700" width="140" height="100" as="geometry" />
          </mxCell>
        </object>

        <!-- RabbitMQ -->
        <object placeholders="1" c4Name="RabbitMQ" c4Type="Container" c4Technology="Message Broker" c4Description="Async messaging with trace propagation" label="&lt;b&gt;%c4Name%&lt;/b&gt;&lt;div&gt;[%c4Type%: %c4Technology%]&lt;/div&gt;&lt;div&gt;%c4Description%&lt;/div&gt;" id="rabbitmq">
          <mxCell style="shape=cylinder3;size=15;direction=south;whiteSpace=wrap;html=1;boundedLbl=1;rounded=0;labelBackgroundColor=none;fillColor=#23A2D9;fontSize=11;fontColor=#ffffff;align=center;strokeColor=#0E7DAD;" parent="1" vertex="1">
            <mxGeometry x="620" y="570" width="200" height="100" as="geometry" />
          </mxCell>
        </object>

        <!-- S3 Storage -->
        <object placeholders="1" c4Name="S3 Storage" c4Type="Container" c4Technology="S3" c4Description="3D files storage" label="&lt;b&gt;%c4Name%&lt;/b&gt;&lt;div&gt;[%c4Type%: %c4Technology%]&lt;/div&gt;" id="s3">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;fontSize=11;labelBackgroundColor=none;fillColor=#23A2D9;fontColor=#ffffff;align=center;arcSize=10;strokeColor=#0E7DAD;" parent="1" vertex="1">
            <mxGeometry x="920" y="560" width="140" height="70" as="geometry" />
          </mxCell>
        </object>

        <!-- NEW: Tracing Infrastructure (RED) -->
        <object placeholders="1" c4Name="OpenTelemetry Collector" c4Type="Container" c4Technology="OTel Collector" c4Description="Collects and processes traces from all services" label="&lt;b&gt;%c4Name%&lt;/b&gt;&lt;div&gt;[%c4Type%: %c4Technology%]&lt;/div&gt;&lt;div&gt;%c4Description%&lt;/div&gt;" id="otel-collector">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;fontSize=11;labelBackgroundColor=none;fillColor=#FF0000;fontColor=#ffffff;align=center;arcSize=10;strokeColor=#CC0000;" parent="1" vertex="1">
            <mxGeometry x="1150" y="450" width="180" height="90" as="geometry" />
          </mxCell>
        </object>

        <object placeholders="1" c4Name="Jaeger" c4Type="Container" c4Technology="Jaeger" c4Description="Distributed tracing backend and UI" label="&lt;b&gt;%c4Name%&lt;/b&gt;&lt;div&gt;[%c4Type%: %c4Technology%]&lt;/div&gt;&lt;div&gt;%c4Description%&lt;/div&gt;" id="jaeger">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;fontSize=11;labelBackgroundColor=none;fillColor=#FF0000;fontColor=#ffffff;align=center;arcSize=10;strokeColor=#CC0000;" parent="1" vertex="1">
            <mxGeometry x="1150" y="590" width="180" height="90" as="geometry" />
          </mxCell>
        </object>

        <object placeholders="1" c4Name="Elasticsearch" c4Type="Container" c4Technology="Elasticsearch" c4Description="Storage for Jaeger traces" label="&lt;b&gt;%c4Name%&lt;/b&gt;&lt;div&gt;[%c4Type%: %c4Technology%]&lt;/div&gt;&lt;div&gt;%c4Description%&lt;/div&gt;" id="elasticsearch">
          <mxCell style="shape=cylinder3;size=15;whiteSpace=wrap;html=1;boundedLbl=1;rounded=0;labelBackgroundColor=none;fillColor=#FF0000;fontSize=11;fontColor=#ffffff;align=center;strokeColor=#CC0000;" parent="1" vertex="1">
            <mxGeometry x="1150" y="730" width="180" height="100" as="geometry" />
          </mxCell>
        </object>

        <!-- Connections: Users to Frontends -->
        <mxCell id="edge-customer-shop" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#333333;" parent="1" source="customer" target="shop-frontend" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge-seller-crm" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#333333;" parent="1" source="seller" target="crm-frontend" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge-operator-mes" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#333333;" parent="1" source="operator" target="mes-frontend" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge-apiuser-mesapi" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#333333;" parent="1" source="api-user" target="mes-api" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Connections: Frontends to APIs -->
        <mxCell id="edge-shopfe-shopapi" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#333333;" parent="1" source="shop-frontend" target="shop-api" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge-crmfe-crmapi" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#333333;" parent="1" source="crm-frontend" target="crm-api" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge-mesfe-mesapi" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#333333;" parent="1" source="mes-frontend" target="mes-api" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Connections: APIs to Databases -->
        <mxCell id="edge-shopapi-shopdb" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#333333;" parent="1" source="shop-api" target="shop-db" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge-crmapi-shopdb" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#333333;" parent="1" source="crm-api" target="shop-db" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge-mesapi-mesdb" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#333333;" parent="1" source="mes-api" target="mes-db" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Connections: APIs to RabbitMQ -->
        <mxCell id="edge-crmapi-rabbit" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#333333;startArrow=classic;startFill=1;" parent="1" source="crm-api" target="rabbitmq" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge-mesapi-rabbit" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#333333;startArrow=classic;startFill=1;" parent="1" source="mes-api" target="rabbitmq" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Connections: APIs to S3 -->
        <mxCell id="edge-shopapi-s3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#333333;" parent="1" source="shop-api" target="s3" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="850" y="295" />
              <mxPoint x="850" y="595" />
            </Array>
          </mxGeometry>
        </mxCell>

        <mxCell id="edge-mesapi-s3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#333333;" parent="1" source="mes-api" target="s3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- NEW: Tracing connections (RED) -->
        <mxCell id="edge-shopapi-otel" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#FF0000;dashed=1;" parent="1" source="shop-api" target="otel-collector" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1100" y="295" />
              <mxPoint x="1100" y="495" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="label-shopapi-otel" value="OTLP traces" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#FF0000;" parent="edge-shopapi-otel" vertex="1" connectable="0">
          <mxGeometry x="0.3" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>

        <mxCell id="edge-crmapi-otel" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#FF0000;dashed=1;" parent="1" source="crm-api" target="otel-collector" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="label-crmapi-otel" value="OTLP traces" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#FF0000;" parent="edge-crmapi-otel" vertex="1" connectable="0">
          <mxGeometry x="0.3" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>

        <mxCell id="edge-mesapi-otel" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#FF0000;dashed=1;" parent="1" source="mes-api" target="otel-collector" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1100" y="755" />
              <mxPoint x="1100" y="495" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="label-mesapi-otel" value="OTLP traces" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#FF0000;" parent="edge-mesapi-otel" vertex="1" connectable="0">
          <mxGeometry x="0.3" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>

        <mxCell id="edge-otel-jaeger" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#FF0000;" parent="1" source="otel-collector" target="jaeger" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge-jaeger-es" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#FF0000;" parent="1" source="jaeger" target="elasticsearch" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Legend -->
        <mxCell id="legend-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#333333;" parent="1" vertex="1">
          <mxGeometry x="1150" y="900" width="200" height="100" as="geometry" />
        </mxCell>
        <mxCell id="legend-title" value="Legend" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=12;" parent="1" vertex="1">
          <mxGeometry x="1150" y="905" width="200" height="20" as="geometry" />
        </mxCell>
        <mxCell id="legend-existing" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#23A2D9;strokeColor=#0E7DAD;" parent="1" vertex="1">
          <mxGeometry x="1160" y="935" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="legend-existing-text" value="Existing components" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1190" y="935" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="legend-new" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FF0000;strokeColor=#CC0000;" parent="1" vertex="1">
          <mxGeometry x="1160" y="965" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="legend-new-text" value="NEW: Tracing components" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#FF0000;" parent="1" vertex="1">
          <mxGeometry x="1190" y="965" width="150" height="20" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
